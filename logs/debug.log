2024-10-18T12:17:45.065442+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (8312), thread 'MainThread' (13564):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000002544B6D4EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000002544B6A20E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-11' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000002544B6CEEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000002544B6CEE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000002544B6FB6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000002544B7725F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000002544F367900>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000002544F3679A0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000002544F367900>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000002544EC8BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000002544F372620>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002544E8A43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002544E8A5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002544E8A4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002544E8BC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002544F39EE00>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002544E8A4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002544F39F4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000002544F0AF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002544ED0BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002544F12BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000002544F1D4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002544F12B5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002544F12BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000002544F24EF60>
    └ <function await_only at 0x000002544E7A65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000002544F2EFEC0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000002544F30ECC0 (otid=0x000002544E757630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000002544F2EFEC0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 350, in <module>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000002544BE75990>
    └ <uvicorn.server.Server object at 0x000002544F25AE90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000002544BE75A20>
           │       │   └ <uvicorn.server.Server object at 0x000002544F25AE90>
           │       └ <function run at 0x0000025449B08AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000002544F1A6B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000002544B6CE170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002544B771CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002544B6CFBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002544B6037F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002544F34BF40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372C80>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002544F258160>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002544F34BF40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372C80>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372C80>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002544F3704C0>
          └ <fastapi.applications.FastAPI object at 0x000002544F258160>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002544F366DD0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002544F370490>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002544F3704C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002544F366DD0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002544F372B60>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002544F258310>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002544F370490>
          └ <function wrap_app_handling_exceptions at 0x000002544E3529E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366D40>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002544F258310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366D40>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002544F258310>>
          └ <fastapi.routing.APIRouter object at 0x000002544F258310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366D40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002544E353EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366D40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002544F26D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366D40>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002544F373190>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002544F367490>
          └ <function wrap_app_handling_exceptions at 0x000002544E3529E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002544F366E60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002544F372...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002544F367490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002544F373190>
                     └ <function get_request_handler.<locals>.app at 0x000002544F26D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002544E369A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000002544F26D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002544F25B9A0>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000002544F201A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000002544F372FE0>
                 └ <function get_bitrix_auth at 0x000002544F201990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000002544F372B00>
                   │       └ <function AsyncSession.execute at 0x000002544F096F80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000002544F372FE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000002544E7A6710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000002544F30ECC0 (otid=0x000002544E757630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000002544F014B80>
           └ <sqlalchemy.orm.session.Session object at 0x000002544F372AA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000002544F014AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000002544F372AA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000002544F0077F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002544F0CD340>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002544F0CD340>
                └ <function SessionTransaction._connection_for_bind at 0x000002544F0076D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000002544EC8BB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000002544EC89C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000002544EC8BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000002544F372620>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002544E8A43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002544E8A5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002544E8A4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002544E8BC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002544F39EE00>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002544E8A4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002544F39F4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000002544F0AF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000002544F1640A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002544F3A0EE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002544ED0BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002544F12BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000002544F1D4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002544F12B5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002544F12BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000002544F24EF60>
    └ <function await_only at 0x000002544E7A65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000002544F2EFEC0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000002544F30ECC0 (otid=0x000002544E757630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000002544F2EFEC0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:19:55.712377+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (14332), thread 'MainThread' (6496):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001B192504EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001B1924D20E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001B1924FEEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001B1924FEE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001B19252B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001B1925A25F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001B196197750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001B1961977F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001B196197750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001B195ABBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001B1961A1B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001B1956D43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001B1956D5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001B1956D4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001B1956EC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001B1961CE2C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001B1956D4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001B1961CE1C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001B195EDF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001B195B3BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001B195F5BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001B196004CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001B195F5B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001B195F5BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001B19607EF60>
    └ <function await_only at 0x000001B1955D65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001B19619F180>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001B195F6A040 (otid=0x000001B1955875A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001B19619F180>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001B1960880D0>
    │       └ <function run at 0x000001B192CA6050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001B192CA5990>
    └ <uvicorn.server.Server object at 0x000001B19608AE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001B192CA5A20>
           │       │   └ <uvicorn.server.Server object at 0x000001B19608AE00>
           │       └ <function run at 0x000001B190938AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001B195FD6B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001B1924FE170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001B1925A1CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001B1924FFBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001B1924337F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B19613E950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1480>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001B1960880D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B19613E950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1480>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1480>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B1961A0490>
          └ <fastapi.applications.FastAPI object at 0x000001B1960880D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001B196196E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B1961A0460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B1961A0490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001B196196E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001B1961A0EE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001B196088280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B1961A0460>
          └ <function wrap_app_handling_exceptions at 0x000001B1951829E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B196196EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001B196088280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B196196EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001B196088280>>
          └ <fastapi.routing.APIRouter object at 0x000001B196088280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B196196EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001B195183EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B196196EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001B19609D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B196196EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001B1961A0D00>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001B196197010>
          └ <function wrap_app_handling_exceptions at 0x000001B1951829E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B1961970A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B1961A1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001B196197010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001B1961A0D00>
                     └ <function get_request_handler.<locals>.app at 0x000001B19609D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001B195199A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001B19609D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001B19608B910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001B196031A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001B1961A15D0>
                 └ <function get_bitrix_auth at 0x000001B196031990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001B1961A1720>
                   │       └ <function AsyncSession.execute at 0x000001B195EC6F80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001B1961A15D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001B1955D6710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001B195F6A040 (otid=0x000001B1955875A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001B195E48B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001B1961A1780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001B195E48AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001B1961A1780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001B195E377F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B195B75340>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B195B75340>
                └ <function SessionTransaction._connection_for_bind at 0x000001B195E376D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001B195ABBB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001B195AB9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001B195ABBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001B1961A1B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001B1956D43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001B1956D5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001B1956D4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001B1956EC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001B1961CE2C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001B1956D4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001B1961CE1C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001B195EDF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001B195F98190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001B1961BC880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001B195B3BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001B195F5BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001B196004CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001B195F5B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001B195F5BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001B19607EF60>
    └ <function await_only at 0x000001B1955D65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001B19619F180>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001B195F6A040 (otid=0x000001B1955875A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001B19619F180>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:21:58.621810+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (13540), thread 'MainThread' (8540):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x0000012B87314EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x0000012B872F20E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x0000012B8730EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x0000012B8730EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x0000012B8733B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x0000012B873B25F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x0000012B8AF17750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x0000012B8AF177F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x0000012B8AF17750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x0000012B8A83BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x0000012B8AF21BA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x0000012B8A4543A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000012B8A455C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000012B8A454DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x0000012B8A46C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000012B8AF4E500>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000012B8A454160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000012B8AF4E3C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x0000012B8AC5F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x0000012B8A8BBE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x0000012B8ACDBA30>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000012B8AD84CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x0000012B8ACDB580>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x0000012B8ACDBA30>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x0000012B8ADFEF60>
    └ <function await_only at 0x0000012B8A3565F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x0000012B8AF1F400>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000012B8AE9C1C0 (otid=0x0000012B8A3075D0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x0000012B8AF1F400>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x0000012B8AE08100>
    │       └ <function run at 0x0000012B87A66050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x0000012B87A65990>
    └ <uvicorn.server.Server object at 0x0000012B8AE0AE30>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x0000012B87A65A20>
           │       │   └ <uvicorn.server.Server object at 0x0000012B8AE0AE30>
           │       └ <function run at 0x0000012B85958AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x0000012B8AD56B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x0000012B8730E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000012B873B1CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000012B8730FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000012B872537F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000012B8AEFBF40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF214B0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000012B8AE08100>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000012B8AEFBF40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF214B0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF214B0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000012B8AF204C0>
          └ <fastapi.applications.FastAPI object at 0x0000012B8AE08100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000012B8AF16E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000012B8AF20490>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000012B8AF204C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000012B8AF16E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000012B8AF20F10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000012B8AE082B0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000012B8AF20490>
          └ <function wrap_app_handling_exceptions at 0x0000012B89F029E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF16EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000012B8AE082B0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF16EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000012B8AE082B0>>
          └ <fastapi.routing.APIRouter object at 0x0000012B8AE082B0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF16EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000012B89F03EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF16EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000012B8AE1D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF16EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000012B8AF20D30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000012B8AF17010>
          └ <function wrap_app_handling_exceptions at 0x0000012B89F029E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000012B8AF170A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000012B8AF21...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000012B8AF17010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000012B8AF20D30>
                     └ <function get_request_handler.<locals>.app at 0x0000012B8AE1D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000012B89F19A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x0000012B8AE1D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000012B8AE0B940>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x0000012B8ADB1A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000012B8AF21600>
                 └ <function get_bitrix_auth at 0x0000012B8ADB1990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x0000012B8AF21750>
                   │       └ <function AsyncSession.execute at 0x0000012B8AC46F80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000012B8AF21600>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x0000012B8A356710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000012B8AE9C1C0 (otid=0x0000012B8A3075D0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000012B8ABC4B80>
           └ <sqlalchemy.orm.session.Session object at 0x0000012B8AF217B0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x0000012B8ABC4AF0>
           └ <sqlalchemy.orm.session.Session object at 0x0000012B8AF217B0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x0000012B8ABB77F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000012B8AEB0240>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000012B8AEB0240>
                └ <function SessionTransaction._connection_for_bind at 0x0000012B8ABB76D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x0000012B8A83BB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x0000012B8A839C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x0000012B8A83BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x0000012B8AF21BA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x0000012B8A4543A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000012B8A455C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000012B8A454DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x0000012B8A46C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000012B8AF4E500>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000012B8A454160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000012B8AF4E3C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x0000012B8AC5F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x0000012B8AD14040>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000012B8AF40820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x0000012B8A8BBE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x0000012B8ACDBA30>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000012B8AD84CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x0000012B8ACDB580>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x0000012B8ACDBA30>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x0000012B8ADFEF60>
    └ <function await_only at 0x0000012B8A3565F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x0000012B8AF1F400>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000012B8AE9C1C0 (otid=0x0000012B8A3075D0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x0000012B8AF1F400>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:23:59.350588+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (13400), thread 'MainThread' (996):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x0000018188844EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x00000181888120E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001818883EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001818883EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001818886B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x00000181888E25F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001818C4D7750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001818C4D77F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001818C4D7750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001818BDFBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001818C4E1AE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001818BA143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001818BA15C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001818BA14DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001818BA2C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001818C50E2C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001818BA14160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001818C50E180>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001818C21B400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001818BE7BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001818C29B970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001818C344CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001818C29B4C0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001818C29B970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001818C3BEF60>
    └ <function await_only at 0x000001818B9165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001818C4DB100>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001818C2BFA80 (otid=0x000001818B8C7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001818C4DB100>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001818C3CC100>
    │       └ <function run at 0x0000018188FE6050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x0000018188FE5990>
    └ <uvicorn.server.Server object at 0x000001818C3CED70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x0000018188FE5A20>
           │       │   └ <uvicorn.server.Server object at 0x000001818C3CED70>
           │       └ <function run at 0x0000018186C38AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001818C316B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001818883E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000181888E1CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001818883FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000181887737F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001818C4828C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E13F0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001818C3CC100>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001818C4828C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E13F0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E13F0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001818C4E0400>
          └ <fastapi.applications.FastAPI object at 0x000001818C3CC100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001818C4D6E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001818C4E03D0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001818C4E0400>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001818C4D6E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001818C4E0E50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001818C3CC0D0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001818C4E03D0>
          └ <function wrap_app_handling_exceptions at 0x000001818B4C29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D6EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001818C3CC0D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D6EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001818C3CC0D0>>
          └ <fastapi.routing.APIRouter object at 0x000001818C3CC0D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D6EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001818B4C3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001818C3DD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D6EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001818C4E0C70>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001818C4D7010>
          └ <function wrap_app_handling_exceptions at 0x000001818B4C29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001818C4D70A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001818C4E1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001818C4D7010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001818C4E0C70>
                     └ <function get_request_handler.<locals>.app at 0x000001818C3DD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001818B4D9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001818C3DD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001818C3CF880>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001818C371A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001818C4E1540>
                 └ <function get_bitrix_auth at 0x000001818C371990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001818C4E1690>
                   │       └ <function AsyncSession.execute at 0x000001818C20EF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001818C4E1540>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001818B916710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001818C2BFA80 (otid=0x000001818B8C7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001818C188B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001818C4E16F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001818C188AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001818C4E16F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001818C1777F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001818C453B00>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001818C453B00>
                └ <function SessionTransaction._connection_for_bind at 0x000001818C1776D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001818BDFBB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001818BDF9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001818BDFBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001818C4E1AE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001818BA143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001818BA15C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001818BA14DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001818BA2C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001818C50E2C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001818BA14160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001818C50E180>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001818C21B400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001818C2D8100>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001818C500820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001818BE7BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001818C29B970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001818C344CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001818C29B4C0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001818C29B970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001818C3BEF60>
    └ <function await_only at 0x000001818B9165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001818C4DB100>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001818C2BFA80 (otid=0x000001818B8C7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001818C4DB100>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:24:46.529351+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (12836), thread 'MainThread' (3924):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001D466994EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001D4669720E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001D46698EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001D46698EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001D4669BB6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001D466A325F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001D46A607750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001D46A6077F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001D46A607750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D469F2BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D46A611C00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D469B443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D469B45C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D469B44DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D469B5C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D46A63E4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D469B44160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D46A63E380>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D46A34F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D469FABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D46A3CBA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D46A474CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D46A3CB5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D46A3CBA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D46A4EEF60>
    └ <function await_only at 0x000001D469A465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D46A60F200>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D46A5A1100 (otid=0x000001D4699F7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D46A60F200>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001D46A4F8160>
    │       └ <function run at 0x000001D467116050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001D467115990>
    └ <uvicorn.server.Server object at 0x000001D46A4FAE90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001D467115A20>
           │       │   └ <uvicorn.server.Server object at 0x000001D46A4FAE90>
           │       └ <function run at 0x000001D464FD8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001D46A446B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001D46698E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001D466A31CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001D46698FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001D4668D37F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D46A5EBFA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611510>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001D46A4F8160>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D46A5EBFA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611510>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611510>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D46A610520>
          └ <fastapi.applications.FastAPI object at 0x000001D46A4F8160>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D46A606E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D46A6104F0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D46A610520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D46A606E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001D46A610F70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001D46A4F8310>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D46A6104F0>
          └ <function wrap_app_handling_exceptions at 0x000001D4695F29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A606EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001D46A4F8310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A606EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001D46A4F8310>>
          └ <fastapi.routing.APIRouter object at 0x000001D46A4F8310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A606EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001D4695F3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A606EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001D46A50D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A606EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001D46A610D90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001D46A607010>
          └ <function wrap_app_handling_exceptions at 0x000001D4695F29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D46A6070A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D46A611...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001D46A607010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001D46A610D90>
                     └ <function get_request_handler.<locals>.app at 0x000001D46A50D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001D469609A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001D46A50D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001D46A4FB9A0>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001D46A4A1A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D46A611660>
                 └ <function get_bitrix_auth at 0x000001D46A4A1990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001D46A6117B0>
                   │       └ <function AsyncSession.execute at 0x000001D46A33EF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D46A611660>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001D469A46710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001D46A5A1100 (otid=0x000001D4699F7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001D46A2B8B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001D46A611810>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001D46A2B8AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001D46A611810>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001D46A2A77F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D46A58E340>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D46A58E340>
                └ <function SessionTransaction._connection_for_bind at 0x000001D46A2A76D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001D469F2BB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001D469F29C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D469F2BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D46A611C00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D469B443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D469B45C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D469B44DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D469B5C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D46A63E4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D469B44160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D46A63E380>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D46A34F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D46A4040A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D46A630880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D469FABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D46A3CBA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D46A474CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D46A3CB5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D46A3CBA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D46A4EEF60>
    └ <function await_only at 0x000001D469A465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D46A60F200>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D46A5A1100 (otid=0x000001D4699F7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D46A60F200>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:26:23.942201+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (14288), thread 'MainThread' (14176):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001DF314E4EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001DF314B20E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001DF314DEEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001DF314DEE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001DF3150B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001DF315825F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001DF35177750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001DF351777F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001DF35177750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001DF34A9BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001DF35181AB0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001DF346B43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001DF346B5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001DF346B4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001DF346CC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DF351AE5C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001DF346B4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DF351AE4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001DF34EBF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001DF34B1BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DF34F3B940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001DF34FE4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001DF34F3B490>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DF34F3B940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001DF3505EF60>
    └ <function await_only at 0x000001DF345B65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DF3517F3C0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001DF3511ECC0 (otid=0x000001DF345674E0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DF3517F3C0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001DF3506C0A0>
    │       └ <function run at 0x000001DF31C86050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001DF31C85990>
    └ <uvicorn.server.Server object at 0x000001DF3506ED40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001DF31C85A20>
           │       │   └ <uvicorn.server.Server object at 0x000001DF3506ED40>
           │       └ <function run at 0x000001DF2F8C8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001DF34FB6B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001DF314DE170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001DF31581CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001DF314DFBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001DF314137F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001DF35126890>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF351813C0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001DF3506C0A0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001DF35126890>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF351813C0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF351813C0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001DF351803D0>
          └ <fastapi.applications.FastAPI object at 0x000001DF3506C0A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001DF35176E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001DF351803A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001DF351803D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001DF35176E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001DF35180E20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001DF3506C040>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001DF351803A0>
          └ <function wrap_app_handling_exceptions at 0x000001DF341629E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF35176EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001DF3506C040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF35176EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001DF3506C040>>
          └ <fastapi.routing.APIRouter object at 0x000001DF3506C040>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF35176EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001DF34163EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF35176EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001DF3507D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF35176EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001DF35180C40>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001DF35177010>
          └ <function wrap_app_handling_exceptions at 0x000001DF341629E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DF351770A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DF35181...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001DF35177010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001DF35180C40>
                     └ <function get_request_handler.<locals>.app at 0x000001DF3507D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001DF34179A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001DF3507D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001DF3506F850>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001DF35011A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001DF35181510>
                 └ <function get_bitrix_auth at 0x000001DF35011990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001DF35181660>
                   │       └ <function AsyncSession.execute at 0x000001DF34EAEF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001DF35181510>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001DF345B6710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001DF3511ECC0 (otid=0x000001DF345674E0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001DF34E28B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001DF351816C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001DF34E28AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001DF351816C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001DF34DFF7F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001DF35112D40>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001DF35112D40>
                └ <function SessionTransaction._connection_for_bind at 0x000001DF34DFF6D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001DF34A9BB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001DF34A99C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001DF34A9BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001DF35181AB0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001DF346B43A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001DF346B5C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001DF346B4DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001DF346CC940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DF351AE5C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001DF346B4160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DF351AE4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001DF34EBF400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DF34F74490>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DF351A0820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001DF34B1BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DF34F3B940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001DF34FE4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001DF34F3B490>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DF34F3B940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001DF3505EF60>
    └ <function await_only at 0x000001DF345B65F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DF3517F3C0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001DF3511ECC0 (otid=0x000001DF345674E0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DF3517F3C0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T12:29:34.417753+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (4796), thread 'MainThread' (5676):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001DE77AA4EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001DE77A720E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001DE77A9EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001DE77A9EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001DE77ACB6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001DE77B425F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001DE7B737750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001DE7B7377F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001DE7B737750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001DE7B05BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001DE7B741B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001DE7AC743A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001DE7AC75C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001DE7AC74DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001DE7AC8C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DE7B76E340>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001DE7AC74160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DE7B76E200>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001DE7B47F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001DE7B0DBE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DE7B4FBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001DE7B5A4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001DE7B4FB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DE7B4FBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001DE7B61EF60>
    └ <function await_only at 0x000001DE7AB765F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DE7B73F200>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001DE7A477280 (otid=0x000001DE7AB275A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DE7B73F200>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001DE7B6280D0>
    │       └ <function run at 0x000001DE78246050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001DE78245990>
    └ <uvicorn.server.Server object at 0x000001DE7B62AE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001DE78245A20>
           │       │   └ <uvicorn.server.Server object at 0x000001DE7B62AE00>
           │       └ <function run at 0x000001DE75ED8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001DE7B576B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001DE77A9E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001DE77B41CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001DE77A9FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001DE779D37F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001DE7B6E2950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741480>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001DE7B6280D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001DE7B6E2950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741480>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741480>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001DE7B740490>
          └ <fastapi.applications.FastAPI object at 0x000001DE7B6280D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001DE7B736E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001DE7B740460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001DE7B740490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001DE7B736E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001DE7B740EE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001DE7B628280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001DE7B740460>
          └ <function wrap_app_handling_exceptions at 0x000001DE7A7229E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B736EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001DE7B628280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B736EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001DE7B628280>>
          └ <fastapi.routing.APIRouter object at 0x000001DE7B628280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B736EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001DE7A723EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B736EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001DE7B63D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B736EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001DE7B740D00>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001DE7B737010>
          └ <function wrap_app_handling_exceptions at 0x000001DE7A7229E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001DE7B7370A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001DE7B741...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001DE7B737010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001DE7B740D00>
                     └ <function get_request_handler.<locals>.app at 0x000001DE7B63D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001DE7A739A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001DE7B63D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001DE7B62B910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001DE7B5D1A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001DE7B7415D0>
                 └ <function get_bitrix_auth at 0x000001DE7B5D1990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001DE7B741720>
                   │       └ <function AsyncSession.execute at 0x000001DE7B466F80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001DE7B7415D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001DE7AB76710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001DE7A477280 (otid=0x000001DE7AB275A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001DE7B3E8B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001DE7B741780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001DE7B3E8AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001DE7B741780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001DE7B3D77F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001DE7B49DB40>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001DE7B49DB40>
                └ <function SessionTransaction._connection_for_bind at 0x000001DE7B3D76D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001DE7B05BB50>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001DE7B059C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001DE7B05BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001DE7B741B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001DE7AC743A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           └ Engine(mysql+asyncmy://u2842936_admin_s:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001DE7AC75C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001DE7AC74DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001DE7AC8C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DE7B76E340>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001DE7AC74160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001DE7B76E200>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001DE7B47F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001DE7B538190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001DE7B75C880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001DE7B0DBE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DE7B4FBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001DE7B5A4CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001DE7B4FB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001DE7B4FBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_admin_s', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001DE7B61EF60>
    └ <function await_only at 0x000001DE7AB765F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DE7B73F200>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001DE7A477280 (otid=0x000001DE7AB275A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001DE7B73F200>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T13:44:17.237772+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (13404), thread 'MainThread' (14008):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001F6C5364EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001F6C53420E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001F6C535EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001F6C535EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001F6C538B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001F6C54025F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001F6C8FD7750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001F6C8FD77F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001F6C8FD7750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001F6C88FBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001F6C8FE1B40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001F6C85143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001F6C8515C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001F6C8514DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001F6C852C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001F6C900E100>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001F6C8514160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001F6C8DBFD00>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001F6C8DC2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001F6C897BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001F6C8D9B9D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001F6C8E44D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001F6C8D9B520>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001F6C8D9B9D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001F6C8EBEF60>
    └ <function await_only at 0x000001F6C84165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001F6C8FDF080>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001F6C8F7ECC0 (otid=0x000001F6C83C7570) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001F6C8FDF080>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001F6C8ECC0A0>
    │       └ <function run at 0x000001F6C5AE6050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001F6C5AE5990>
    └ <uvicorn.server.Server object at 0x000001F6C8ECEDD0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001F6C5AE5A20>
           │       │   └ <uvicorn.server.Server object at 0x000001F6C8ECEDD0>
           │       └ <function run at 0x000001F6C39A8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001F6C8E16B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001F6C535E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001F6C5401CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001F6C535FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001F6C52A37F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001F6C8F86920>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1450>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001F6C8ECC0A0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001F6C8F86920>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1450>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1450>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001F6C8FE0460>
          └ <fastapi.applications.FastAPI object at 0x000001F6C8ECC0A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001F6C8FD6E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001F6C8FE0430>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001F6C8FE0460>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001F6C8FD6E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001F6C8FE0EB0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001F6C8ECC250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001F6C8FE0430>
          └ <function wrap_app_handling_exceptions at 0x000001F6C7FC29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD6EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001F6C8ECC250>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD6EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001F6C8ECC250>>
          └ <fastapi.routing.APIRouter object at 0x000001F6C8ECC250>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD6EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001F6C7FC3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001F6C8EDD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD6EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001F6C8FE0CD0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001F6C8FD7010>
          └ <function wrap_app_handling_exceptions at 0x000001F6C7FC29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001F6C8FD70A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001F6C8FE1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001F6C8FD7010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001F6C8FE0CD0>
                     └ <function get_request_handler.<locals>.app at 0x000001F6C8EDD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001F6C7FD9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001F6C8EDD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001F6C8ECF8E0>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001F6C8E71A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001F6C8FE15A0>
                 └ <function get_bitrix_auth at 0x000001F6C8E71990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001F6C8FE16F0>
                   │       └ <function AsyncSession.execute at 0x000001F6C8D06F80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001F6C8FE15A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001F6C8416710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001F6C8F7ECC0 (otid=0x000001F6C83C7570) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001F6C8C88B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001F6C8FE1750>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001F6C8C88AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001F6C8FE1750>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001F6C8C777F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F6C8EAEF40>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F6C8EAEF40>
                └ <function SessionTransaction._connection_for_bind at 0x000001F6C8C776D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001F6C88FBB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001F6C88F9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001F6C88FBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001F6C8FE1B40>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001F6C85143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001F6C8515C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001F6C8514DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001F6C852C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001F6C900E100>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001F6C8514160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001F6C8DBFD00>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001F6C8DC2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001F6C8DD4520>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001F6C9000760>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001F6C897BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001F6C8D9B9D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001F6C8E44D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001F6C8D9B520>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001F6C8D9B9D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001F6C8EBEF60>
    └ <function await_only at 0x000001F6C84165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001F6C8FDF080>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001F6C8F7ECC0 (otid=0x000001F6C83C7570) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001F6C8FDF080>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T13:46:13.330673+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (2392), thread 'MainThread' (11556):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000002900CC44EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000002900CC220E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000002900CC3EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000002900CC3EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000002900CC6B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000002900CCE25F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x00000290108C7750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x00000290108C77F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x00000290108C7750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000290101EBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000290108D1B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002900FE043A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002900FE05C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002900FE04DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002900FE1C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000290108FE600>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002900FE04160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000290108CB4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000290106B2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002901026BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000029010734D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002901068B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000290107AEF60>
    └ <function await_only at 0x000002900FD065F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000290108CB640>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000029010843B00 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000290108CB640>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>
    │       └ <function run at 0x000002900D3D6050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000002900D3D5990>
    └ <uvicorn.server.Server object at 0x00000290107BAE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000002900D3D5A20>
           │       │   └ <uvicorn.server.Server object at 0x00000290107BAE00>
           │       └ <function run at 0x000002900B088AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x0000029010706B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000002900CC3E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002900CCE1CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002900CC3FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002900CB837F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000029010872950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1480>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000029010872950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1480>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1480>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000290108D0490>
          └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000290108C6E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000290108D0460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000290108D0490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000290108C6E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000290108D0EE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000290107B8280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000290108D0460>
          └ <function wrap_app_handling_exceptions at 0x000002900F8B29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C6EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000290107B8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C6EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000290107B8280>>
          └ <fastapi.routing.APIRouter object at 0x00000290107B8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C6EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002900F8B3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000290107CD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C6EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000290108D0D00>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000290108C7010>
          └ <function wrap_app_handling_exceptions at 0x000002900F8B29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C70A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000290108C7010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000290108D0D00>
                     └ <function get_request_handler.<locals>.app at 0x00000290107CD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002900F8C9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x00000290107CD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000290107BB910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x0000029010761A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000290108D15D0>
                 └ <function get_bitrix_auth at 0x0000029010761990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x00000290108D1720>
                   │       └ <function AsyncSession.execute at 0x00000290105FEF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000290108D15D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000002900FD06710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000029010843B00 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000029010578B80>
           └ <sqlalchemy.orm.session.Session object at 0x00000290108D1780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x0000029010578AF0>
           └ <sqlalchemy.orm.session.Session object at 0x00000290108D1780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x00000290105677F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000029010862B80>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000029010862B80>
                └ <function SessionTransaction._connection_for_bind at 0x00000290105676D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x00000290101EBB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000290101E9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000290101EBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000290108D1B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002900FE043A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002900FE05C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002900FE04DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002900FE1C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000290108FE600>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002900FE04160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000290108CB4C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000290106B2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000290108F07C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002901026BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000029010734D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002901068B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000290107AEF60>
    └ <function await_only at 0x000002900FD065F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000290108CB640>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000029010843B00 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000290108CB640>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T13:46:28.608808+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (2392), thread 'MainThread' (11556):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000002900CC44EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000002900CC220E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-11' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000002900CC3EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000002900CC3EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000002900CC6B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000002900CCE25F0>
                 │    └ <IocpProactor overlapped#=2 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x0000029010BB3870>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x0000029010BB3910>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x0000029010BB3870>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000290101EBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000290108D3820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002900FE043A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002900FE05C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002900FE04DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002900FE1C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000029010C4A280>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002900FE04160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000029010C49580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000290106B2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002901026BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000029010734D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002901068B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000290107AEF60>
    └ <function await_only at 0x000002900FD065F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x0000029010C49700>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000029010C48700 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x0000029010C49700>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>
    │       └ <function run at 0x000002900D3D6050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000002900D3D5990>
    └ <uvicorn.server.Server object at 0x00000290107BAE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000002900D3D5A20>
           │       │   └ <uvicorn.server.Server object at 0x00000290107BAE00>
           │       └ <function run at 0x000002900B088AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x0000029010706B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000002900CC3E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002900CCE1CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002900CC3FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002900CB837F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000029010872950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D33D0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000029010872950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D33D0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D33D0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000290108D0490>
          └ <fastapi.applications.FastAPI object at 0x00000290107B80D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000290108C6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000290108D0460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000290108D0490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000290108C6EF0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000290108D3490>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000290107B8280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000290108D0460>
          └ <function wrap_app_handling_exceptions at 0x000002900F8B29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C7010>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000290107B8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C7010>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000290107B8280>>
          └ <fastapi.routing.APIRouter object at 0x00000290107B8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C7010>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002900F8B3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C7010>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000290107CD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290108C7010>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000290108D2890>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000290108C70A0>
          └ <function wrap_app_handling_exceptions at 0x000002900F8B29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000290109089D0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000290108D3...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000290108C70A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000290108D2890>
                     └ <function get_request_handler.<locals>.app at 0x00000290107CD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002900F8C9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x00000290107CD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000290107BB910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x0000029010761A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000290108D3550>
                 └ <function get_bitrix_auth at 0x0000029010761990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x00000290108D3520>
                   │       └ <function AsyncSession.execute at 0x00000290105FEF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000290108D3550>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000002900FD06710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000029010C48700 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000029010578B80>
           └ <sqlalchemy.orm.session.Session object at 0x00000290108D3580>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x0000029010578AF0>
           └ <sqlalchemy.orm.session.Session object at 0x00000290108D3580>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x00000290105677F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000029010C48E00>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000029010C48E00>
                └ <function SessionTransaction._connection_for_bind at 0x00000290105676D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x00000290101EBB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000290101E9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000290101EBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000290108D3820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000002900FE043A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000002900FE05C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000002900FE04DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000002900FE1C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000029010C4A280>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000002900FE04160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000029010C49580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000290106B2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000290106C4190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000029010BB8880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000002901026BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x0000029010734D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000002901068B550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000002901068BA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000290107AEF60>
    └ <function await_only at 0x000002900FD065F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x0000029010C49700>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x0000029010C48700 (otid=0x000002900FCB75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x0000029010C49700>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T13:46:37.737618+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (10760), thread 'MainThread' (8924):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x00000286D0FB4EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x00000286D0F920E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x00000286D0FAEEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x00000286D0FAEE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x00000286D0FDB6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x00000286D10525F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x00000286D4BD7750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x00000286D4BD77F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x00000286D4BD7750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000286D44FBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000286D4BE1C00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x00000286D41143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000286D4115C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000286D4114DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000286D412C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000286D4C0E180>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000286D4114160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000286D4A9C680>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000286D49C2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000286D457BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000286D499BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x00000286D4A44D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x00000286D499B5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000286D499BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000286D4ABEF60>
    └ <function await_only at 0x00000286D40165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000286D4BDF000>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x00000286D4B53980 (otid=0x00000286D3FC7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000286D4BDF000>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x00000286D4AC8160>
    │       └ <function run at 0x00000286D1706050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x00000286D1705990>
    └ <uvicorn.server.Server object at 0x00000286D4ACAE90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x00000286D1705A20>
           │       │   └ <uvicorn.server.Server object at 0x00000286D4ACAE90>
           │       └ <function run at 0x00000286CF5F8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x00000286D4A16B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x00000286D0FAE170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000286D1051CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000286D0FAFBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000286D0EF37F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000286D4BBBFA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1510>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000286D4AC8160>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000286D4BBBFA0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1510>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1510>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000286D4BE0520>
          └ <fastapi.applications.FastAPI object at 0x00000286D4AC8160>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000286D4BD6E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000286D4BE04F0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000286D4BE0520>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000286D4BD6E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000286D4BE0F70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000286D4AC8310>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000286D4BE04F0>
          └ <function wrap_app_handling_exceptions at 0x00000286D3BBE9E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD6EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000286D4AC8310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD6EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000286D4AC8310>>
          └ <fastapi.routing.APIRouter object at 0x00000286D4AC8310>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD6EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000286D3BBFEB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000286D4ADD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD6EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000286D4BE0D90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000286D4BD7010>
          └ <function wrap_app_handling_exceptions at 0x00000286D3BBE9E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000286D4BD70A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000286D4BE1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000286D4BD7010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000286D4BE0D90>
                     └ <function get_request_handler.<locals>.app at 0x00000286D4ADD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000286D3BD5A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x00000286D4ADD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000286D4ACB9A0>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x00000286D4A71A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000286D4BE1660>
                 └ <function get_bitrix_auth at 0x00000286D4A71990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x00000286D4BE17B0>
                   │       └ <function AsyncSession.execute at 0x00000286D490AF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000286D4BE1660>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x00000286D4016710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x00000286D4B53980 (otid=0x00000286D3FC7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x00000286D4884B80>
           └ <sqlalchemy.orm.session.Session object at 0x00000286D4BE1810>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x00000286D4884AF0>
           └ <sqlalchemy.orm.session.Session object at 0x00000286D4BE1810>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x00000286D48777F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000286D493D600>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000286D493D600>
                └ <function SessionTransaction._connection_for_bind at 0x00000286D48776D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x00000286D44FBB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000286D44F9C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000286D44FBBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000286D4BE1C00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x00000286D41143A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost:3306/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000286D4115C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000286D4114DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000286D412C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000286D4C0E180>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000286D4114160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000286D4A9C680>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000286D49C2EF0>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000286D49D40A0>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000286D4C00940>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000286D457BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000286D499BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x00000286D4A44D30>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x00000286D499B5E0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000286D499BA90>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'port': 3306, 'cl...
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000286D4ABEF60>
    └ <function await_only at 0x00000286D40165F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000286D4BDF000>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x00000286D4B53980 (otid=0x00000286D3FC7630) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000286D4BDF000>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T13:47:12.618181+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (12512), thread 'MainThread' (3432):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x00000133F8584EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x00000133F85620E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x00000133F857EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x00000133F857EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x00000133F85AB6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x00000133F86225F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x00000133FC1F7750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x00000133FC1F77F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x00000133FC1F7750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000133FBB1BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000133FC201AE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x00000133FB7343A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000133FB735C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000133FB734DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000133FB74C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000133FC22E440>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000133FB734160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000133FC22E340>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000133FBF3B400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000133FBB9BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000133FBFBB970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x00000133FC064CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x00000133FBFBB4C0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000133FBFBB970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000133FC0DEF60>
    └ <function await_only at 0x00000133FB6365F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000133FC1FF280>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x00000133FC01E7C0 (otid=0x00000133FB5E7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000133FC1FF280>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x00000133FC0EC100>
    │       └ <function run at 0x00000133F8D06050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x00000133F8D05990>
    └ <uvicorn.server.Server object at 0x00000133FC0EED70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x00000133F8D05A20>
           │       │   └ <uvicorn.server.Server object at 0x00000133FC0EED70>
           │       └ <function run at 0x00000133F69C8AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x00000133FC036B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x00000133F857E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000133F8621CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000133F857FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000133F84C37F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000133FC1A68C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC2013F0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000133FC0EC100>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000133FC1A68C0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC2013F0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC2013F0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000133FC200400>
          └ <fastapi.applications.FastAPI object at 0x00000133FC0EC100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000133FC1F6E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000133FC2003D0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000133FC200400>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000133FC1F6E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000133FC200E50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000133FC0EC0D0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000133FC2003D0>
          └ <function wrap_app_handling_exceptions at 0x00000133FB1E29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F6EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000133FC0EC0D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F6EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000133FC0EC0D0>>
          └ <fastapi.routing.APIRouter object at 0x00000133FC0EC0D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F6EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000133FB1E3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F6EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000133FC0FD900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F6EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000133FC200C70>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000133FC1F7010>
          └ <function wrap_app_handling_exceptions at 0x00000133FB1E29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000133FC1F70A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000133FC201...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000133FC1F7010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000133FC200C70>
                     └ <function get_request_handler.<locals>.app at 0x00000133FC0FD870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000133FB1F9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x00000133FC0FD1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000133FC0EF880>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x00000133FC091A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000133FC201540>
                 └ <function get_bitrix_auth at 0x00000133FC091990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x00000133FC201690>
                   │       └ <function AsyncSession.execute at 0x00000133FBF2EF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000133FC201540>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x00000133FB636710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x00000133FC01E7C0 (otid=0x00000133FB5E7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x00000133FBEA8B80>
           └ <sqlalchemy.orm.session.Session object at 0x00000133FC2016F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x00000133FBEA8AF0>
           └ <sqlalchemy.orm.session.Session object at 0x00000133FC2016F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x00000133FBE977F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000133FC190A80>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000133FC190A80>
                └ <function SessionTransaction._connection_for_bind at 0x00000133FBE976D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x00000133FBB1BB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000133FBB19C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x00000133FBB1BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x00000133FC201AE0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x00000133FB7343A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000133FB735C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000133FB734DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000133FB74C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000133FC22E440>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000133FB734160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000133FC22E340>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000133FBF3B400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x00000133FBFF8100>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000133FC220880>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000133FBB9BE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000133FBFBB970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x00000133FC064CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x00000133FBFBB4C0>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x00000133FBFBB970>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x00000133FC0DEF60>
    └ <function await_only at 0x00000133FB6365F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x00000133FC1FF280>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x00000133FC01E7C0 (otid=0x00000133FB5E7510) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x00000133FC1FF280>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T14:02:17.460891+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (3620), thread 'MainThread' (2832):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001D577E64EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001D577E320E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-7' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310\...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001D577E5EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001D577E5EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001D577E8B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001D577F025F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001D57BB07750>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001D57BB077F0>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001D57BB07750>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D57B42BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D57BB11B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D57B0443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D57B045C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D57B044DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D57B05C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BB3E540>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D57B044160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BB3E400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D57B84F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D57B4ABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D57B974CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D57B8CB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D57B9EEF60>
    └ <function await_only at 0x000001D57AF465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BB0F0C0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D57B86DB80 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BB0F0C0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>
    │       └ <function run at 0x000001D578606050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001D578605990>
    └ <uvicorn.server.Server object at 0x000001D57B9FAE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001D578605A20>
           │       │   └ <uvicorn.server.Server object at 0x000001D57B9FAE00>
           │       └ <function run at 0x000001D576248AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001D57B946B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001D577E5E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001D577F01CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001D577E5FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001D577D937F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D57BAAE950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11480>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D57BAAE950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11480>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11480>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D57BB10490>
          └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D57BB06E60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D57BB10460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D57BB10490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D57BB06E60>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001D57BB10EE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D57BB10460>
          └ <function wrap_app_handling_exceptions at 0x000001D57AAE29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB06EF0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB06EF0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001D57B9F8280>>
          └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB06EF0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001D57AAE3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB06EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001D57BA0D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB06EF0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001D57BB10D00>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001D57BB07010>
          └ <function wrap_app_handling_exceptions at 0x000001D57AAE29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB070A0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB11...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001D57BB07010>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001D57BB10D00>
                     └ <function get_request_handler.<locals>.app at 0x000001D57BA0D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001D57AAF9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001D57BA0D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001D57B9FB910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001D57B9A1A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D57BB115D0>
                 └ <function get_bitrix_auth at 0x000001D57B9A1990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001D57BB11720>
                   │       └ <function AsyncSession.execute at 0x000001D57B83EF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D57BB115D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001D57AF46710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001D57B86DB80 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001D57B7B8B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001D57BB11780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001D57B7B8AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001D57BB11780>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001D57B7A77F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D57AD70A80>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D57AD70A80>
                └ <function SessionTransaction._connection_for_bind at 0x000001D57B7A76D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001D57B42BB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001D57B429C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D57B42BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D57BB11B70>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D57B0443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D57B045C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D57B044DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D57B05C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BB3E540>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D57B044160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BB3E400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D57B84F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BB30820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D57B4ABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D57B974CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D57B8CB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D57B9EEF60>
    └ <function await_only at 0x000001D57AF465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BB0F0C0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D57B86DB80 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BB0F0C0>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-10-18T14:02:48.658184+0300 - ERROR - An error has been caught in function 'run_endpoint_function', process 'MainProcess' (3620), thread 'MainThread' (2832):
Traceback (most recent call last):

  File "asyncmy\\connection.pyx", line 565, in asyncmy.connection.Connection.connect
    raise
  File "asyncmy\\connection.pyx", line 556, in asyncmy.connection.Connection.connect
    self._reader, self._writer = await asyncio.wait_for(asyncio.open_connection(
                                       │       │        │       └ <function open_connection at 0x000001D577E64EE0>
                                       │       │        └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>
                                       │       └ <function wait_for at 0x000001D577E320E0>
                                       └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
           │   └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-11' coro=<open_connection() done, defined at C:\Users\Админ\AppData\Local\Programs\Python\Python310...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x000001D577E5EEF0>
                         └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1060, in create_connection
    raise exceptions[0]
          └ [ConnectionRefusedError(22, 'Удаленный компьютер отклонил это сетевое подключение', None, 1225, None), ConnectionRefusedError...

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x000001D577E5EE60>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 3306, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x000001D577E8B6D0>
          └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 3306, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x000001D577F025F0>
                 │    └ <IocpProactor overlapped#=3 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x000001D57BDF7870>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x000001D57BDF7910>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x000001D57BDF7870>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D57B42BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D57BB13820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D57B0443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D57B045C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D57B044DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D57B05C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BE8E740>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D57B044160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BE8E600>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D57B84F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D57B4ABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D57B974CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D57B8CB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D57B9EEF60>
    └ <function await_only at 0x000001D57AF465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BE8DB00>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D57BB3EB00 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BE8DB00>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

asyncmy.errors.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\Админ\Desktop\handler\handler.py", line 349, in <module>
    uvicorn.run(app, host="127.0.0.1", log_config="logs/log_config.json", use_colors=True, log_level="info")
    │       │   └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>
    │       └ <function run at 0x000001D578606050>
    └ <module 'uvicorn' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\uvicorn\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\main.py", line 577, in run
    server.run()
    │      └ <function Server.run at 0x000001D578605990>
    └ <uvicorn.server.Server object at 0x000001D57B9FAE00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x000001D578605A20>
           │       │   └ <uvicorn.server.Server object at 0x000001D57B9FAE00>
           │       └ <function run at 0x000001D576248AF0>
           └ <module 'asyncio' from 'C:\\Users\\Админ\\AppData\\Local\\Programs\\Python\\Python310\\lib\\asyncio\\__init__.py'>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001D57B946B90>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001D577E5E170>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 628, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001D577F01CF0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 595, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001D577E5FBE0>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1881, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001D577D937F0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 406, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D57BAAE950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB133D0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D57BAAE950>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB133D0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB133D0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D57BB10490>
          └ <fastapi.applications.FastAPI object at 0x000001D57B9F80D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D57BB06EF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D57BB10460>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D57BB10490>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D57BB06EF0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001D57BB13490>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D57BB10460>
          └ <function wrap_app_handling_exceptions at 0x000001D57AAE29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB07010>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 754, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB07010>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001D57B9F8280>>
          └ <fastapi.routing.APIRouter object at 0x000001D57B9F8280>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 774, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB07010>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001D57AAE3EB0>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 295, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB07010>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001D57BA0D900>
          └ APIRoute(path='/reboot_tokens/', name='reboot_tokens', methods=['POST'])

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB07010>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001D57BB128C0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001D57BB070A0>
          └ <function wrap_app_handling_exceptions at 0x000001D57AAE29E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D57BB489D0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D57BB13...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001D57BB070A0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\starlette\routing.py", line 74, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001D57BB128C0>
                     └ <function get_request_handler.<locals>.app at 0x000001D57BA0D870>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 297, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001D57AAF9A20>

> File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\fastapi\routing.py", line 210, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'client_secret': 'evsnQmXW25jFQFzowrg6XyLxjBLGLTqZ0CTtLZS5v9r4mo5c89'}
                 │         └ <function reboot_tokens at 0x000001D57BA0D1B0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001D57B9FB910>

  File "C:\Users\Админ\Desktop\handler\handler.py", line 55, in reboot_tokens
    access = await get_bitrix_auth()
                   └ <function get_bitrix_auth at 0x000001D57B9A1A20>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 26, in wrapper
    return await func(session, *args, **kwargs)  # Передаем сессию в функцию
                 │    │         │       └ {}
                 │    │         └ ()
                 │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D57BB13550>
                 └ <function get_bitrix_auth at 0x000001D57B9A1990>

  File "C:\Users\Админ\Desktop\handler\db\database.py", line 33, in get_bitrix_auth
    result = await session.execute(stmt)
                   │       │       └ <sqlalchemy.sql.selectable.Select object at 0x000001D57BB13520>
                   │       └ <function AsyncSession.execute at 0x000001D57B83EF80>
                   └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001D57BB13550>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001D57AF46710>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001D57BB3EB00 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001D57B7B8B80>
           └ <sqlalchemy.orm.session.Session object at 0x000001D57BB13580>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
           │    │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <function Session._connection_for_bind at 0x000001D57B7B8AF0>
           └ <sqlalchemy.orm.session.Session object at 0x000001D57BB13580>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           │     │                    │       └ None
           │     │                    └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │     └ <function SessionTransaction._connection_for_bind at 0x000001D57B7A77F0>
           └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D57BE8D100>

  File "<string>", line 2, in _connection_for_bind

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ (Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db), None)
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001D57BE8D100>
                └ <function SessionTransaction._connection_for_bind at 0x000001D57B7A76D0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           │    └ <function Engine.connect at 0x000001D57B42BB50>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x000001D57B429C60>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...
          │                    │              └ (<class 'asyncmy.errors.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(asyncmy.errors.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 1225] ...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x000001D57B42BBE0>
    │                        └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)
    └ <sqlalchemy.engine.base.Connection object at 0x000001D57BB13820>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x000001D57B0443A0>
           │    └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ Engine(mysql+asyncmy://u2842936_grigory:***@localhost/u2842936_main_db)

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x000001D57B045C60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x000001D57B044DC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x000001D57B05C940>
          └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BE8E740>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x000001D57B044160>
           └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D57BE8E600>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетево...

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000001D57B84F400>
    │    │                               └ <sqlalchemy.pool.impl.AsyncAdaptedQueuePool object at 0x000001D57B908190>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000001D57BDFC8E0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x000001D57B4ABE20>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\engine\default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <function AsyncAdapt_asyncmy_dbapi.connect at 0x000001D57B974CA0>
           │    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_dbapi object at 0x000001D57B8CB550>
           └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x000001D57B8CBA00>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\dialects\mysql\asyncmy.py", line 284, in connect
    await_only(creator_fn(*arg, **kw)),
    │          │           │      └ {'host': 'localhost', 'db': 'u2842936_main_db', 'user': 'u2842936_grigory', 'password': 'yX3pF7tW5kaU8sV3', 'client_flag': 2}
    │          │           └ ()
    │          └ <cyfunction connect at 0x000001D57B9EEF60>
    └ <function await_only at 0x000001D57AF465F0>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BE8DB00>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x000001D57BB3EB00 (otid=0x000001D57AEF75A0) dead>

  File "C:\Users\Админ\Desktop\handler\venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <asyncmy.contexts._ConnectionContextManager object at 0x000001D57BE8DB00>

  File "asyncmy\\connection.pyx", line 1343, in _connect
    await conn.connect()
  File "asyncmy\\connection.pyx", line 588, in connect
    raise errors.OperationalError(
          │      └ <class 'asyncmy.errors.OperationalError'>
          └ <module 'asyncmy.errors' from 'C:\\Users\\Админ\\Desktop\\handler\\venv\\lib\\site-packages\\asyncmy\\errors.cp310-win_amd64....

sqlalchemy.exc.OperationalError: (asyncmy.errors.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 1225] Удаленный компьютер отклонил это сетевое подключение)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
